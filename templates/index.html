<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Psychology Classification</title>
    <script>
        let postCount = 0; // To keep track of the number of pet fields
        let friendCount = 0; // To keep track of the number of friend fields
        let photoCount = 0; // To keep track of the number of photo fields
        let groupCount = 0; // To keep track of the number of group fields
        let userCount = 0; // To keep track of the number of user fields
        let biographyCount = 0; // To keep track of the number of biography fields

        function addPostField() {
            postCount++;
            const postField = document.createElement('div');
            postField.innerHTML = `
                <input type="number" id="postId${postCount}" placeholder="Post PostId" required>
                <input type="number" id="postUserId${postCount}" placeholder="Post UserId" required>
                <input type="text" id="postText${postCount}" placeholder="Post Text" required>
                <input type="number" id="postIsOwner${postCount}" placeholder="Post IsOwner" required>
                <input type="number" id="postDate${postCount}" placeholder="Post Date" required>
                <button type="button" onclick="removeField(this)">Remove Post</button>
            `;
            document.getElementById('posts').appendChild(postField);
        }

        function addGroupField() {
            groupCount++;
            const groupField = document.createElement('div');
            groupField.innerHTML = `
                <input type="number" id="groupId${groupCount}" placeholder="Group GroupId" required>
                <input type="number" id="groupUserId${groupCount}" placeholder="Group UserId" required>
                <input type="text" id="groupName${groupCount}" placeholder="Group Name" required>
                <input type="text" id="groupDescription${groupCount}" placeholder="Group Description" required>
                <button type="button" onclick="removeField(this)">Remove Group</button>
            `;
            document.getElementById('groups').appendChild(groupField);
        }

        function addFriendField() {
            friendCount++;
            const friendField = document.createElement('div');
            friendField.innerHTML = `
                <input type="number" id="friendId${friendCount}" placeholder="Friend FriendId" required>
                <input type="number" id="friendUserId${friendCount}" placeholder="Friend UserId" required>
                <input type="text" id="friendFirstName${friendCount}" placeholder="Friend FirstName" required>
                <input type="text" id="friendLastName${friendCount}" placeholder="Friend LastName" required>
                <input type="text" id="friendCity${friendCount}" placeholder="Friend City" required>
                <input type="text" id="friendEducation${friendCount}" placeholder="Friend Education" required>
                <input type="text" id="friendWork${friendCount}" placeholder="Friend Work" required>
                <button type="button" onclick="removeField(this)">Remove Friend</button>
            `;
            document.getElementById('friends').appendChild(friendField);
        }

        function addPhotoField() {
            photoCount++;
            const photoField = document.createElement('div');
            photoField.innerHTML = `
                <input type="number" id="photoId${photoCount}" placeholder="Photo PhotoId" required>
                <input type="number" id="photoUserId${photoCount}" placeholder="Photo UserId" required>
                <input type="text" id="photoImgToTxt${photoCount}" placeholder="Photo ImgToTxt" required>
                <input type="text" id="photoUrl${photoCount}" placeholder="Photo Url" required>
                <input type="number" id="photoLikeCount${photoCount}" placeholder="Photo LikeCount" required>
                <button type="button" onclick="removeField(this)">Remove Photo</button>
            `;
            document.getElementById('photos').appendChild(photoField);
        }

        function addUserField() {
            userCount++;
            const userField = document.createElement('div');
            userField.innerHTML = `
                <input type="number" id="userId${userCount}" placeholder="User UserId" required>
                <input type="number" id="userVkId${userCount}" placeholder="User VkId" required>
                <input type="text" id="userFirstName${userCount}" placeholder="User FirstName" required>
                <input type="text" id="userLastName${userCount}" placeholder="User LastName" required>
                <input type="text" id="userBirthDate${userCount}" placeholder="User BirthDate" required>
                <input type="number" id="userAge${userCount}" placeholder="User Age" required step="0.01" min="0"> <!-- Float input -->
                <button type="button" onclick="removeField(this)">Remove User</button>
            `;
            document.getElementById('users').appendChild(userField);
        }

        function addBiographyField() {
            biographyCount++;
            const biographyField = document.createElement('div');
            biographyField.innerHTML = `
                <input type="number" id="biographyId${biographyCount}" placeholder="Biography BiographyId" required>
                <input type="number" id="biographyUserId${biographyCount}" placeholder="Biography UserId" required>
                <input type="text" id="biographyActivity${biographyCount}" placeholder="Biography Activity" required>
                <input type="text" id="biographyInterests${biographyCount}" placeholder="Biography Interests" required>
                <input type="text" id="biographyMusic${biographyCount}" placeholder="Biography Music" required>
                <input type="text" id="biographyFilms${biographyCount}" placeholder="Biography Films" required>
                <input type="text" id="biographyTv${biographyCount}" placeholder="Biography Tv" required>
                <input type="text" id="biographyBooks${biographyCount}" placeholder="Biography Books" required>
                <input type="text" id="biographyGames${biographyCount}" placeholder="Biography Games" required>
                <input type="text" id="biographyQuotes${biographyCount}" placeholder="Biography Quotes" required>
                <input type="text" id="biographyAbout${biographyCount}" placeholder="Biography About" required>
                <button type="button" onclick="removeField(this)">Remove Biography</button>
            `;
            document.getElementById('biographies').appendChild(biographyField);
        }

        function removeField(button) {
            button.parentElement.remove();
        }

        async function sendData() {

            const posts = [];
            for (let i = 1; i <= postCount; i++) {
                const postId = document.getElementById(`postId${i}`)?.value || '';
                const postUserId = document.getElementById(`postUserId${i}`)?.value || '';
                const postText = document.getElementById(`postText${i}`)?.value || '';
                const postIsOwner = document.getElementById(`postIsOwner${i}`)?.value || '';
                const postDate = document.getElementById(`postDate${i}`)?.value || '';
                if (postId && postUser && postText && postIsOwner && postDate) {
                    posts.push({ id: parseInt(postId), user_id: parseInt(postUserId), text: postText, isowner: parseInt(postIsOwner), date: parseInt(postDate) });
                }
            }

            const friends = [];
            for (let i = 1; i <= friendCount; i++) {
                const friendId = document.getElementById(`friendId${i}`)?.value || '';
                const friendUserId = document.getElementById(`friendUserId${i}`)?.value || '';
                const friendFirstName = document.getElementById(`friendFirstName${i}`)?.value || '';
                const friendLastName = document.getElementById(`friendLastName${i}`)?.value || '';
                const friendCity = document.getElementById(`friendCity${i}`)?.value || '';
                const friendEducation = document.getElementById(`friendEducation${i}`)?.value || '';
                const friendWork = document.getElementById(`friendWork${i}`)?.value || '';
                if (friendId && friendUserId && friendFirstName && friendLastName && friendCity && friendEducation && friendWork) {
                    friends.push({ id: parseInt(friendId), user_id: parseInt(friendUserId), first_name: friendFirstName, last_name: friendLastName, city: friendCity, education: friendEducation, work: friendWork });
                }
            }

            const groups = [];
            for (let i = 1; i <= groupCount; i++) {
                const groupId = document.getElementById(`groupId${i}`)?.value || '';
                const groupUserId = document.getElementById(`groupUserId${i}`)?.value || '';
                const groupName = document.getElementById(`groupName${i}`)?.value || '';
                const groupDescription = document.getElementById(`groupDescription${i}`)?.value || '';
                if (groupId && groupUserId && groupName && groupDescription) {
                    groups.push({ id: parseInt(groupId), user_id: parseInt(groupUserId), name: groupName, description: groupDescription });
                }
            }

            const photos = [];
            for (let i = 1; i <= photoCount; i++) {
                const photoId = document.getElementById(`photoId${i}`)?.value || '';
                const photoUserId = document.getElementById(`photoUserId${i}`)?.value || '';
                const photoImgToTxt = document.getElementById(`photoImgToTxt${i}`)?.value || '';
                const photoUrl = document.getElementById(`photoUrl${i}`)?.value || '';
                const photoLikeCount = document.getElementById(`photoLikeCount${i}`)?.value || '';
                if (photoId && photoUserId && photoImgToTxt && photoUrl && photoLikeCount) {
                    photos.push({ id: parseInt(photoId), user_id: parseInt(photoUserId), igm2txt: photoImgToTxt, url: photoUrl, like_count: parseInt(photoLikeCount) });
                }
            }

            const users = [];
            for (let i = 1; i <= userCount; i++) {
                const userId = document.getElementById(`userId${i}`)?.value || '';
                const userVkId = document.getElementById(`userVkId${i}`)?.value || '';
                const userFirstName = document.getElementById(`userFirstName${i}`)?.value || '';
                const userLastName = document.getElementById(`userLastName${i}`)?.value || '';
                const userBirthDate = document.getElementById(`userBirthDate${i}`)?.value || '';
                const userAge = document.getElementById(`userAge${i}`)?.value || '';
                if (userId && UserVkId && userFirstName && userLastName && userBirthDate && userAge) {
                    users.push({ id: parseInt(userId), vk_id: parseInt(userVkId), first_name: userFirstName, last_name: userLastName, birth_date: userBirthDate, age: parseFloat(userAge) });
                }
            }

            const biographies = [];
            for (let i = 1; i <= biographyCount; i++) {
                const biographyId = document.getElementById(`biographyId${i}`)?.value || '';
                const biographyUserId = document.getElementById(`biographyUserId${i}`)?.value || '';
                const biographyActivity = document.getElementById(`biographyActivity${i}`)?.value || '';
                const biographyInterests = document.getElementById(`biographyInterests${i}`)?.value || '';
                const biographyMusic = document.getElementById(`biographyMusic${i}`)?.value || '';
                const biographyFilms = document.getElementById(`biographyFilms${i}`)?.value || '';
                const biographyTv = document.getElementById(`biographyTv${i}`)?.value || '';
                const biographyBooks = document.getElementById(`biographyBooks${i}`)?.value || '';
                const biographyGames = document.getElementById(`biographyGames${i}`)?.value || '';
                const biographyQuotes = document.getElementById(`biographyQuotes${i}`)?.value || '';
                const biographyAbout = document.getElementById(`biographyAbout${i}`)?.value || '';
                if (biographyId && biographyUserId && biographyActivity && biographyInterests && biographyMusic && biographyFilms && biographyTv && biographyBooks && biographyGames && biographyQuotes && biographyAbout) {
                    biographies.push({ id: parseInt(biographyId), user_id: parseInt(biographyUserId), activity: biographyActivity, interests: biographyInterests, music: biographyMusic, films: biographyMusic, tv: biographyTv, books: biographyBooks, games: biographyGames, quotes: biographyQuotes, about: biographyAbout });
                }
            }

            const data = { users, biographies, posts, friends, groups, photos };

            const response = await fetch('/api/data', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(data),
            });

            const result = await response.json();
            console.log(result);
            displayResponse(result);

        }
        function displayResponse(response) {
            const responseContainer = document.getElementById('response');
            responseContainer.innerHTML = `
                <h3>Response:</h3>
                <pre>${JSON.stringify(response, null, 2)}</pre>
            `;
        }
    </script>
</head>
<body>
    <h1>Psychology Classification</h1>
    <form onsubmit="event.preventDefault(); sendData();">

        <div id="users">
            <h3>Users</h3>
            <button type="button" onclick="addUserField()">Add User</button>
        </div>

        <div id="biographies">
            <h3>Biographies</h3>
            <button type="button" onclick="addBiographyField()">Add Biography</button>
        </div>

        <div id="posts">
            <h3>Posts</h3>
            <button type="button" onclick="addPostField()">Add Post</button>
        </div>

        <div id="friends">
            <h3>Friends</h3>
            <button type="button" onclick="addFriendField()">Add Friend</button>
        </div>

        <div id="groups">
            <h3>Groups</h3>
            <button type="button" onclick="addGroupField()">Add Group</button>
        </div>

        <div id="photos">
            <h3>Photos</h3>
            <button type="button" onclick="addPhotoField()">Add Photo</button>
        </div>

        <button type="submit">Send Data</button>
    </form>
    <div id="response" style="margin-top: 20px;"></div>
</body>
</html>